<% provide(:title, @article.title) %>
<% provide(:bg, 'show-bg') %>

<div class="row">
  <div class="col-sm-12 col-md-9 col-lg-9">
    <div class="article_content">
      <h3><%= @article.title %></h3>
      <table class="table">
        <tr>
          <% if @article.categories.any? %>
            <td class="item">分类:<%= @article.categories.first.name %></td>
          <% end %>
          <td class="item"><%= @article.created_at.to_formatted_s(:db) %></td>
          <td class="item">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-tag" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" d="M2 2v4.586l7 7L13.586 9l-7-7H2zM1 2a1 1 0 0 1 1-1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 1 6.586V2z"/>
              <path fill-rule="evenodd" d="M4.5 5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1zm0 1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"/>
            </svg>
            <%= @article.labels.map {|i| i.name}.join(",") %></td>
          <td class="item">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-eye" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.134 13.134 0 0 0 1.66 2.043C4.12 11.332 5.88 12.5 8 12.5c2.12 0 3.879-1.168 5.168-2.457A13.134 13.134 0 0 0 14.828 8a13.133 13.133 0 0 0-1.66-2.043C11.879 4.668 10.119 3.5 8 3.5c-2.12 0-3.879 1.168-5.168 2.457A13.133 13.133 0 0 0 1.172 8z"/>
              <path fill-rule="evenodd" d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
            </svg>
            <%= @article.views %></td>
          <td class="item">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-chat-square-dots" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" d="M14 1H2a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h2.5a2 2 0 0 1 1.6.8L8 14.333 9.9 11.8a2 2 0 0 1 1.6-.8H14a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 0a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h2.5a1 1 0 0 1 .8.4l1.9 2.533a1 1 0 0 0 1.6 0l1.9-2.533a1 1 0 0 1 .8-.4H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
              <path d="M5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
            </svg>
            <%= @article.comments.length %></td>
        </tr>
      </table>
      <p><%= raw @article.change_title_id %></p>
    </div>

    <hr size="1" noshade="noshade"/>
    <div class="comment">
      <%= form_for [@article, @article.comments.build], remote: true do |f| %>
        <div class="form_content">
          <%= f.text_area :content, class: "form-control", style: "resize:none", rows: 5, placeholder: "发表你的评论……" %>
          <%= f.text_field :name, value: cookies[:name], class: "form-control", placeholder: "名字" %>
          <%= f.text_field :email, value: cookies[:email], class: "form-control", placeholder: "邮箱 your@example.com" %>
        </div>
        <div class="text-right">
          <%= f.submit "发布评论", class: "btn btn-primary", align: "right" %>
        </div>
        <%= render 'shard/error_messages', object: f.object %>
      <% end %>

      <div id="comments_content">
        <%= render "article_comments", article: @article %>
      </div>
    </div>
  </div>
  <div class="col-lg-2 col-md-2 col-sm-12 ">
    <div id="recommend_reading" >

    </div>

    <% if @catalog.any? %>
      <div id="catalog">
        <h2>目录</h2>
        <% @catalog.each do |w| %>
          <li><%= w %></li>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
<script>
    // 点击目录页面上的文字，滚动到相应的位置
    $(document).ready(function () {
        $("#catalog li").click(function () {
            var ele_name = $(this).text();
            $("html, body").animate({scrollTop: $("#" + ele_name).offset().top - 110}, {
                duration: 500,
                easing: "swing"
            });
        });
    });
</script>